[
  {
    "id": 205,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 2,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Directory`)\nWHERE n.active = true\n  AND NOT n.name IN ['__pycache__', 'node_modules', '.git', '.venv', 'venv', 'dist', 'build',\n                     'static', 'assets', 'public', 'images', 'img', 'css', 'js', 'fonts',\n                     'templates', 'views', 'layouts', 'partials']\n  AND NOT n.path =~ '.*(test|spec|__pycache__|node_modules|\\\\.git|\\\\.venv|venv|dist|build).*'\nRETURN n.id as id, n.name as name, labels(n) as labels, properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationComponent elements from source code directories.\n\nAn ApplicationComponent is a modular, deployable part of a system that:\n- Encapsulates related functionality (not just a folder)\n- Has clear boundaries and responsibilities\n- Contains code that works together as a unit\n- Could potentially be a separate module or package\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the directory is\n- community: Which cluster of related code it belongs to\n- kcore: How connected it is to the core codebase\n- is_bridge: Whether it connects different parts of the codebase\n\nReview each candidate and decide which should become ApplicationComponent elements.\n\nINCLUDE directories that:\n- Represent cohesive functional units (services, modules, packages)\n- Have meaningful names indicating purpose\n- Are structural roots of related code\n\nEXCLUDE directories that:\n- Are just organizational containers with no cohesive purpose\n- Contain only configuration or static assets\n- Are too granular (single-file directories)\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"appcomp_user_service\",\n      \"name\": \"User Service\",\n      \"documentation\": \"Handles user authentication, registration, and profile management\",\n      \"source\": \"dir_myproject_src_services_user\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"appcomp_frontend\",\n      \"name\": \"Frontend Application\",\n      \"documentation\": \"React-based web interface for the application\",\n      \"source\": \"dir_myproject_frontend\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-03T09:55:48.193178",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 101,
    "step_name": "ApplicationComponent",
    "phase": "generate",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (d:`Graph:Directory`) WHERE d.active = true RETURN d.id as id, d.name as name, d.path as path",
    "input_model_query": null,
    "instruction": "Group top-level code directories into ApplicationComponents. Use directory name as component name, include repo for context. Avoid nesting unless clear submodules exist.",
    "example": "{\"identifier\":\"app-comp:auth\",\"name\":\"Auth Component\",\"layer\":\"Application\",\"source\":\"Directory:src/auth\",\"confidence\":0.8}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.086589",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 102,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 1,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationService elements from source code methods.\n\nAn ApplicationService represents explicitly exposed application behavior:\n- Web routes and API endpoints\n- Service interfaces that external clients can call\n- Handlers that respond to external requests\n\nEach candidate includes method information and graph metrics.\n\nReview each candidate and decide which should become ApplicationService elements.\n\nINCLUDE methods that:\n- Handle HTTP requests (routes, endpoints, views)\n- Expose functionality to external clients\n- Are entry points for user interactions\n- Have names suggesting they respond to requests\n\nEXCLUDE methods that:\n- Are internal/private helpers\n- Are utility functions\n- Are lifecycle methods (__init__, setup, etc.)\n- Only perform internal processing\n\nWhen naming:\n- Use service-oriented names (e.g., \"Invoice Form Service\" not \"invoice_form\")\n- Describe what the service provides\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_invoice_form\",\n      \"name\": \"Invoice Form Service\",\n      \"documentation\": \"Web endpoint for creating and managing invoice data through a form interface\",\n      \"source\": \"method_invoice_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_pdf\",\n      \"name\": \"PDF Export Service\",\n      \"documentation\": \"Endpoint for generating and downloading invoice PDFs\",\n      \"source\": \"method_invoice_pdf\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.089040",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 218,
    "step_name": "ApplicationService",
    "phase": "generate",
    "version": 2,
    "sequence": 2,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationService elements from source code methods.\n\nAn ApplicationService represents explicitly exposed application behavior:\n- Web routes and API endpoints (Flask routes, Express handlers)\n- Service interfaces that external clients can call\n- Entry points for user-facing functionality\n\nReview each candidate and ONLY create ApplicationService elements for PRIMARY entry points.\n\nINCLUDE methods that:\n- Handle HTTP requests (routes, endpoints, views)\n- Are decorated with @app.route, @router.get, etc.\n- Are the main entry point for a user action\n- Have names like: index, create, update, delete, list, show\n\nEXCLUDE methods that:\n- Are internal/private helpers (start with _)\n- Are utility functions (formatters, validators, checks)\n- Are lifecycle methods (__init__, setup, teardown)\n- Are callback handlers or hooks\n- Are filter functions (like Jinja filters)\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: as_<action>_<entity>\n2. Use Title Case for display name\n3. Derive name from the method's primary function, not repo-specific terms\n4. Group similar routes into logical services (e.g., form handling, data export)\n5. Keep names generic and applicable to any codebase\n\nSTRICT RULES:\n1. ONLY create ApplicationService for route handlers, NOT for helper methods\n2. Max 3-5 ApplicationService elements per application\n3. Group similar functionality - don't create separate services for each route\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"as_create_entity\",\n      \"name\": \"Create Entity Service\",\n      \"documentation\": \"Web endpoint for creating new entities through a form interface\",\n      \"source\": \"method_create_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"as_export_document\",\n      \"name\": \"Document Export Service\",\n      \"documentation\": \"Endpoint for generating and exporting documents\",\n      \"source\": \"method_export\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:16:55.257636",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 103,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "Derive ApplicationInterface elements from API interfaces, routes, endpoints.\nInterfaces are the access points to application services.",
    "example": "{\"elements\": [{\"identifier\": \"app-int:api\", \"name\": \"REST API Interface\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.091465",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 209,
    "step_name": "ApplicationInterface",
    "phase": "generate",
    "version": 2,
    "sequence": 3,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND f.fileType = \"source\" AND (f.fileName CONTAINS \"route\" OR f.fileName CONTAINS \"api\" OR f.fileName CONTAINS \"endpoint\" OR f.fileName CONTAINS \"controller\") RETURN f.id as id, f.fileName as name, f.filePath as path",
    "input_model_query": null,
    "instruction": "You are identifying ApplicationInterface elements from source code files.\n\nAn ApplicationInterface is a point of access where application services are made available:\n- REST API definitions (OpenAPI, Swagger)\n- GraphQL schemas\n- RPC interfaces (gRPC, SOAP)\n- WebSocket endpoints\n- CLI command interfaces\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become ApplicationInterface elements.\n\nINCLUDE files that:\n- Define API routes or endpoints\n- Contain interface specifications\n- Export service contracts\n- Define command-line interfaces\n\nEXCLUDE files that:\n- Are internal routing helpers\n- Contain only implementation (no interface definition)\n- Are test files or mocks\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: app_int_<name>\n2. Use Title Case for display name\n3. Keep names generic (e.g., \"REST API\" not \"Flask REST API v2\")\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"app_int_rest_api\",\n      \"name\": \"REST API\",\n      \"documentation\": \"HTTP REST interface exposing application services\",\n      \"source\": \"file_api_routes\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"app_int_web_forms\",\n      \"name\": \"Web Forms Interface\",\n      \"documentation\": \"HTML form-based interface for user input\",\n      \"source\": \"file_forms\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:05:57.675500",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 104,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Analyze these code files and derive ArchiMate DataObject elements.\nDataObjects represent data structures, configuration files, templates, and data artifacts.\n\nGuidelines:\n- Group related files into logical DataObjects\n- CSS/style files -> \"Stylesheets\" DataObject\n- HTML template files -> \"Templates\" DataObject  \n- Configuration files (.env, .json, .yaml) -> \"Configuration\" DataObject\n- Database files -> \"Database\" DataObject\n- Use descriptive names that reflect the data purpose\n- Each DataObject should represent a cohesive set of data",
    "example": "{\"elements\": [\n  {\"identifier\": \"data-obj:stylesheets\", \"name\": \"Application Stylesheets\", \"documentation\": \"CSS styling files\", \"source\": \"File:*.css\", \"confidence\": 0.8},\n  {\"identifier\": \"data-obj:templates\", \"name\": \"HTML Templates\", \"documentation\": \"Jinja2 template files\", \"source\": \"File:*.html\", \"confidence\": 0.8}\n]}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.094176",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 208,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 2,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying DataObject elements from files in a codebase.\n\nA DataObject represents data structured for automated processing:\n- Database files (SQLite, SQL scripts)\n- Configuration files (JSON, YAML, ENV)\n- Schema definitions\n- Data exchange formats\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become DataObject elements.\n\nINCLUDE files that:\n- Store application data (databases, data files)\n- Define configuration (settings, environment)\n- Define data schemas or structures\n- Are used for data exchange\n\nEXCLUDE files that:\n- Are source code (Python, JavaScript, etc.)\n- Are templates (HTML, Jinja)\n- Are documentation (README, docs)\n- Are static assets (images, CSS)\n\nWhen naming:\n- Use descriptive names (e.g., \"Application Database\" not \"database.db\")\n- Indicate the data's purpose\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing invoices, customers, and line items\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_app_configuration\",\n      \"name\": \"Application Configuration\",\n      \"documentation\": \"Environment configuration for Flask application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-03T10:17:20.456812",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 216,
    "step_name": "DataObject",
    "phase": "generate",
    "version": 3,
    "sequence": 4,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:File`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.fileName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying DataObject elements from files in a codebase.\n\nA DataObject represents data structured for automated processing:\n- Database files (SQLite, SQL scripts)\n- Configuration files (JSON, YAML, ENV)\n- Schema definitions\n- Data exchange formats\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become DataObject elements.\n\nINCLUDE files that:\n- Store application data (databases, data files)\n- Define configuration (settings, environment variables)\n- Contain schema definitions\n- Are data interchange formats\n\nEXCLUDE files that:\n- Are source code (those inform other elements)\n- Are documentation\n- Are test data or fixtures\n- Are build artifacts\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: do_<name>\n2. Use Title Case for display name\n3. Use GENERIC names based on purpose, not filename:\n   - \"Application Database\" (NEVER: \"database.db\", \"sqlite_db\")\n   - \"Application Configuration\" (NEVER: \"config.json\", \"settings.yaml\", \"app_config\")\n   - \"Environment Configuration\" (NEVER: \".env\", \".flaskenv\", \"flask_env\")\n4. ONE DataObject per logical purpose - don't create duplicates for variants\n\nCANONICAL NAMES (always use these exact identifiers):\n- do_application_database: Main application database\n- do_application_configuration: App config (any format)\n- do_environment_configuration: Environment variables\n- do_requirements: Package dependencies\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"do_application_database\",\n      \"name\": \"Application Database\",\n      \"documentation\": \"SQLite database storing application data\",\n      \"source\": \"file_database.db\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"do_environment_configuration\",\n      \"name\": \"Environment Configuration\",\n      \"documentation\": \"Environment variables for application settings\",\n      \"source\": \"file_.flaskenv\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:12:36.940665",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 223,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 3,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome:\n- Complete business activities that deliver value to stakeholders\n- Workflows that involve multiple steps or decisions\n- Processes that would appear in business process documentation\n\nReview each candidate and ONLY create BusinessProcess for HIGH-LEVEL business operations.\n\nINCLUDE methods that:\n- Represent complete business transactions (Create, Update, Fulfill, Process)\n- Would appear in a business process diagram\n- Orchestrate multiple steps to achieve a business outcome\n- Are meaningful to business analysts, not just developers\n\nEXCLUDE methods that:\n- Are purely technical (setup, init, config, database migrations)\n- Are utility functions or helpers\n- Are single CRUD operations on records (those are ApplicationService)\n- Are internal implementation details\n- Generate documents (PDF, reports) - those are ApplicationService\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bp_<verb>_<entity>\n2. Use Title Case for display name with verb + noun format\n3. Focus on OUTCOMES not operations (e.g., 'Create Order' not 'Insert Order Record')\n4. Derive process names from the domain, not from repo-specific terminology\n\nSTRICT RULES:\n1. Max 2-4 BusinessProcess elements per small application\n2. Only include processes with clear business value\n3. Group related operations into single processes\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_order\",\n      \"name\": \"Create Order\",\n      \"documentation\": \"Business process of creating a new order with line items and customer details\",\n      \"source\": \"method_insert_order\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Business process of handling payment transactions\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:52:51.467260",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 105,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves\na specific outcome. It is NOT just any function - it represents a complete\nbusiness activity that delivers value.\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the method is\n- in_degree/out_degree: How connected it is\n\nReview each candidate and decide which should become BusinessProcess elements.\n\nINCLUDE methods that:\n- Represent complete business activities (Create Invoice, Process Payment)\n- Coordinate multiple steps to achieve a business outcome\n- Would be meaningful to a business analyst\n- Are named with verbs indicating business actions\n\nEXCLUDE methods that:\n- Are purely technical (validation, parsing, formatting)\n- Are framework lifecycle methods (__init__, setup, etc.)\n- Are simple getters/setters\n- Are utility/helper functions\n- Only do one small technical step\n\nWhen naming:\n- Use business-friendly verb phrases (e.g., \"Create Invoice\" not \"create_invoice\")\n- Focus on the business outcome, not technical implementation\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_invoice\",\n      \"name\": \"Create Invoice\",\n      \"documentation\": \"Process of generating a new invoice with line items and customer details\",\n      \"source\": \"method_invoice_form\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_process_payment\",\n      \"name\": \"Process Payment\",\n      \"documentation\": \"Handles payment submission and validation for customer orders\",\n      \"source\": \"method_handle_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.100610",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 219,
    "step_name": "BusinessProcess",
    "phase": "generate",
    "version": 2,
    "sequence": 5,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:Method`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessProcess elements from source code methods.\n\nA BusinessProcess represents a sequence of business behaviors that achieves a specific outcome:\n- Complete business activities (Create Invoice, Process Payment)\n- Workflows that deliver value (Order Fulfillment, User Registration)\n- NOT just any function - it must represent a complete business activity\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the method is\n- in_degree/out_degree: How connected it is\n\nReview each candidate and ONLY create BusinessProcess for HIGH-LEVEL business operations.\n\nINCLUDE methods that:\n- Represent complete business transactions\n- Would appear in a business process diagram\n- Create, update, or finalize business entities\n- Are orchestration points (call multiple other methods)\n\nEXCLUDE methods that:\n- Are technical helpers (setup, init, config)\n- Are utility functions\n- Are CRUD operations on single records (those are ApplicationService)\n- Are internal implementation details\n\nSTRICT RULES:\n1. Max 3-5 BusinessProcess elements per application\n2. Focus on OUTCOMES not operations\n3. Database setup/init are NOT business processes\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bp_<process>\n2. Use Title Case for display name\n3. Use verb + noun format: \"Create Invoice\", \"Process Payment\"\n4. CANONICAL PROCESSES (for invoice app):\n   - bp_create_invoice: Creating a new invoice with details\n   - bp_update_invoice: Modifying existing invoice\n   - bp_generate_pdf: PDF generation process\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bp_create_invoice\",\n      \"name\": \"Create Invoice\",\n      \"documentation\": \"Business process of generating a new invoice with line items and customer details\",\n      \"source\": \"method_insert_invoice_details\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bp_update_invoice\",\n      \"name\": \"Update Invoice\",\n      \"documentation\": \"Business process of modifying an existing invoice\",\n      \"source\": \"method_update_invoice_details\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-08T13:16:56.060538",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 215,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 4,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Customer, Order, Invoice)\n- Domain concepts that appear in business conversations\n- Information structures that would appear in business documentation\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the type is\n- community: Which cluster of related code it belongs to\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent business data entities\n- Would appear in database schemas or API responses\n- Are nouns that stakeholders understand\n- Have high pagerank (central to the domain)\n\nEXCLUDE types that:\n- Are utility/helper classes\n- Are UI components or views\n- Are actors/users (those are BusinessActor)\n- Are technical infrastructure\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use SINGULAR form ALWAYS: \"Invoice\" not \"Invoices\", \"Position\" not \"Positions\"\n2. Use lowercase snake_case for identifier: bo_<name>\n3. Use Title Case for display name\n4. MANDATORY CANONICAL NAMES (always use these exact names):\n   - Customer (NEVER: Client, User, Buyer, Account)\n   - Invoice (NEVER: Bill, Receipt)\n   - Position (NEVER: LineItem, Item, Line, Entry)\n   - Order (NEVER: Purchase, Transaction)\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A commercial document issued by a seller to a buyer\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_position\",\n      \"name\": \"Position\",\n      \"documentation\": \"A line item within an invoice representing a product or service\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who receives invoices and makes payments\",\n      \"source\": \"type_Client\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-08T13:12:34.252425",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 222,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 5,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Order, Customer, Product, etc.)\n- Domain concepts that appear in business conversations\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent business data entities\n- Would appear in database schemas or API responses\n- Are nouns that stakeholders understand\n\nEXCLUDE types that:\n- Are utility/helper classes\n- Are UI components or views\n- Are actors/users (those are BusinessActor)\n- Are technical infrastructure\n\nNAMING RULES (MANDATORY - FOLLOW EXACTLY):\n1. Use SINGULAR form ALWAYS: bo_position NOT bo_positions, bo_invoice NOT bo_invoices\n2. Use lowercase snake_case: bo_<name>\n3. NEVER use plural forms in identifiers\n4. CANONICAL NAMES (use these exact identifiers for common concepts):\n   - Invoice data: bo_invoice\n   - Line items/positions: bo_position\n   - Customer data: bo_customer\n   - Order data: bo_order\n\nSTRICT LIMITS:\n- Maximum 3-4 BusinessObject elements\n- Focus only on core domain entities\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A business document representing a billing transaction\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_position\",\n      \"name\": \"Position\",\n      \"documentation\": \"A line item within an invoice or order\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who purchases goods or services\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:44:56.418124",
    "temperature": 0.0,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 106,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 1,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true RETURN b.id as id, b.name as name, b.concept_type as conceptType",
    "input_model_query": null,
    "instruction": "Derive BusinessObject elements from business concepts.\nBusinessObjects represent business entities like Invoice, Customer, Product.",
    "example": "{\"elements\": [{\"identifier\": \"bus-obj:invoice\", \"name\": \"Invoice\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.103300",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 207,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 3,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessObject elements from source code type definitions.\n\nA BusinessObject represents a passive element that has business relevance:\n- Data entities that the business cares about (Customer, Order, Invoice)\n- Domain concepts that appear in business conversations\n- Information structures that would appear in business documentation\n\nEach candidate includes graph metrics to help assess importance:\n- pagerank: How central/important the type is\n- community: Which cluster of related types it belongs to\n- in_degree: How many other types reference it (higher = more important)\n\nReview each candidate and decide which should become BusinessObject elements.\n\nINCLUDE types that:\n- Represent real-world business concepts (Customer, Order, Product)\n- Are data entities that store business information\n- Would be meaningful to a business analyst (not just a developer)\n- Have names that are nouns representing \"things\" the business cares about\n\nEXCLUDE types that:\n- Are purely technical (handlers, adapters, decorators)\n- Are framework/library classes (BaseModel, FlaskForm)\n- Are utility classes (StringHelper, DateUtils)\n- Are internal implementation details\n- Are exceptions or error types\n- Are configuration or settings classes\n\nWhen naming:\n- Use business-friendly names (e.g., \"Invoice\" not \"InvoiceModel\")\n- Capitalize appropriately (e.g., \"Customer Order\" not \"customer_order\")\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bo_invoice\",\n      \"name\": \"Invoice\",\n      \"documentation\": \"A commercial document issued by a seller to a buyer, indicating products, quantities, and prices\",\n      \"source\": \"type_Invoice\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"bo_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"A person or organization that purchases goods or services\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"bo_line_item\",\n      \"name\": \"Line Item\",\n      \"documentation\": \"An individual entry on an invoice representing a product or service with quantity and price\",\n      \"source\": \"type_Position\",\n      \"confidence\": 0.85\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-03T09:58:10.598831",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 204,
    "step_name": "BusinessObject",
    "phase": "generate",
    "version": 2,
    "sequence": 6,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true RETURN b.id as id, b.name as name, b.concept_type as conceptType",
    "input_model_query": null,
    "instruction": "Derive ArchiMate BusinessObject elements from business concepts.\n\nA BusinessObject represents a passive business entity - something the business deals with (Invoice, Order, Customer, Product, Payment).\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use SINGULAR form always (Invoice not Invoices, Customer not Customers)\n2. Use lowercase snake_case for identifier (bus_obj_invoice, bus_obj_customer)\n3. Use Title Case for display name (Invoice, Customer)\n4. Avoid synonyms - pick ONE canonical name:\n   - Customer (not Client, not User, not Buyer)\n   - Order (not Purchase, not Transaction)\n   - Position (not Line Item, not Order Line)\n   - Payment (not Transaction)\n\nINCLUDE: Core business entities that are manipulated by business processes\nEXCLUDE: Technical concepts (templates, configs), UI elements, process steps\n\nOutput stable, deterministic results - same input should always produce same output.",
    "example": "{\"elements\": [{\"identifier\": \"bus-obj:invoice\", \"name\": \"Invoice\", \"confidence\": 0.8}]}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-03T09:55:31.063431",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 107,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 1,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"capability\", \"service\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "Identify business functions from domain concepts. Group related business behaviors by capability or responsibility area.",
    "example": "{\"identifier\":\"bf:payment\",\"name\":\"Payment Processing\",\"description\":\"Handles all payment-related operations\",\"confidence\":0.65}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.105947",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 210,
    "step_name": "BusinessFunction",
    "phase": "generate",
    "version": 2,
    "sequence": 7,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"capability\", \"service\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "You are identifying BusinessFunction elements from business concepts.\n\nA BusinessFunction represents a collection of business behavior based on a chosen set of criteria:\n- Capability areas (Payment Processing, Order Management)\n- Organizational functions (Finance, HR, Sales)\n- Domain responsibilities (Customer Service, Inventory Control)\n\nEach candidate includes concept information and graph metrics.\n\nReview each candidate and decide which should become BusinessFunction elements.\n\nINCLUDE concepts that:\n- Represent a coherent business capability\n- Group related business activities\n- Could be an organizational responsibility\n- Appear as functional areas in business documentation\n\nEXCLUDE concepts that:\n- Are too granular (single operations)\n- Are technical rather than business-oriented\n- Are data entities (those are BusinessObjects)\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: bf_<name>\n2. Use Title Case for display name\n3. Use singular nouns for capability names\n4. Keep names business-oriented, not technical\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"bf_invoice_management\",\n      \"name\": \"Invoice Management\",\n      \"documentation\": \"Business capability for creating, tracking, and processing invoices\",\n      \"source\": \"concept_invoicing\",\n      \"confidence\": 0.85\n    },\n    {\n      \"identifier\": \"bf_payment_processing\",\n      \"name\": \"Payment Processing\",\n      \"documentation\": \"Business capability for handling payment transactions and reconciliation\",\n      \"source\": \"concept_payments\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:07:11.463113",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 211,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 2,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:Method` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.methodName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessEvent elements from business concepts.\n\nA BusinessEvent represents an organizational state change that triggers behavior:\n- Domain events (Order Placed, Payment Received, Invoice Sent)\n- State transitions (Account Activated, Subscription Expired)\n- External triggers (Customer Request, System Alert)\n\nEach candidate includes concept information and graph metrics.\n\nReview each candidate and decide which should become BusinessEvent elements.\n\nINCLUDE concepts that:\n- Represent a point-in-time occurrence\n- Trigger subsequent business processes\n- Mark important state changes\n- Would appear in event-driven architecture\n\nEXCLUDE concepts that:\n- Are ongoing processes (those are BusinessProcess)\n- Are static data (those are BusinessObjects)\n- Are too technical or internal\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: be_<event_name>\n2. Use Title Case for display name\n3. Use past tense for completed events (e.g., \"Invoice Generated\")\n4. Use present tense for triggers (e.g., \"Payment Due\")\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"be_invoice_generated\",\n      \"name\": \"Invoice Generated\",\n      \"documentation\": \"Event triggered when a new invoice is created in the system\",\n      \"source\": \"concept_invoice_creation\",\n      \"confidence\": 0.9\n    },\n    {\n      \"identifier\": \"be_payment_received\",\n      \"name\": \"Payment Received\",\n      \"documentation\": \"Event triggered when payment is successfully processed\",\n      \"source\": \"concept_payment\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:07:14.037233",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 108,
    "step_name": "BusinessEvent",
    "phase": "generate",
    "version": 1,
    "sequence": 8,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (b:`Graph:BusinessConcept`) WHERE b.active = true AND b.conceptType IN [\"process\", \"event\"] RETURN b.id as id, b.conceptName as name, b.conceptType as conceptType, b.description as description",
    "input_model_query": null,
    "instruction": "Map domain events to BusinessEvent elements. Focus on state changes that trigger business processes or decisions.",
    "example": "{\"identifier\":\"be:order-placed\",\"name\":\"Order Placed\",\"trigger\":\"Customer completes checkout\",\"confidence\":0.6}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.108475",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 217,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 2,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\n  AND (n.out_degree > 0 OR n.pagerank > 0.01)\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties,\n       n.pagerank as pagerank,\n       n.kcore_level as kcore_level",
    "input_model_query": null,
    "instruction": "You are identifying BusinessActor elements from source code types and concepts.\n\nA BusinessActor represents a business entity capable of performing behavior:\n- Users and roles (Customer, Administrator, Operator)\n- Organizational units (Department, Team)\n- External parties (Supplier, Partner)\n\nEach candidate includes graph metrics to help assess importance.\n\nReview each candidate and decide which should become BusinessActor elements.\n\nINCLUDE types that:\n- Represent people or organizational roles\n- Can take actions or make decisions\n- Would appear in user stories or use cases\n- Have names ending in -er, -or, -ist, or role titles\n\nEXCLUDE types that:\n- Are data entities (those are BusinessObject) - Customer DATA is BusinessObject, Customer ROLE is BusinessActor\n- Are processes or functions\n- Are technical components\n\nIMPORTANT DISTINCTION:\n- If a type represents DATA about a customer/user → BusinessObject\n- If a type represents the ROLE/ACTOR who performs actions → BusinessActor\n- When in doubt, prefer BusinessObject for data-centric types\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: ba_<role>\n2. Use Title Case for display name\n3. Use role names, not data names:\n   - \"Invoice Creator\" (for the person creating invoices)\n   - \"System Administrator\" (for admin role)\n\nOutput stable, deterministic results. Only create BusinessActor elements when the type clearly represents an actor/role, not just data.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_invoice_creator\",\n      \"name\": \"Invoice Creator\",\n      \"documentation\": \"User role responsible for creating and managing invoices\",\n      \"source\": \"concept_user\",\n      \"confidence\": 0.8\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:12:39.293693",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 109,
    "step_name": "BusinessActor",
    "phase": "generate",
    "version": 1,
    "sequence": 9,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n)\nWHERE (n:`Graph:TypeDefinition` OR n:`Graph:BusinessConcept`)\n  AND n.active = true\nRETURN n.id as id,\n       COALESCE(n.name, n.typeName, n.conceptName) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying BusinessActor elements from source code types and concepts.\n\nA BusinessActor represents a business entity capable of performing behavior:\n- Users and roles (Customer, Administrator, Operator)\n- Organizational units (Department, Team)\n- External parties (Supplier, Partner)\n- System actors when they represent a logical role\n\nEach candidate includes graph metrics to help assess importance.\n\nReview each candidate and decide which should become BusinessActor elements.\n\nINCLUDE types that:\n- Represent people, roles, or organizational entities\n- Can initiate or perform business activities\n- Would appear in a business context diagram\n- Have names indicating actors (User, Customer, Manager, etc.)\n\nEXCLUDE types that:\n- Represent data/information (Invoice, Order, Report)\n- Are technical components (Controller, Handler, Service)\n- Are utility/framework classes\n- Are abstract base classes\n\nWhen naming:\n- Use role names (e.g., \"Customer\" not \"CustomerModel\")\n- Be specific about the actor's function\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"ba_customer\",\n      \"name\": \"Customer\",\n      \"documentation\": \"External party who purchases products or services and receives invoices\",\n      \"source\": \"type_Customer\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"ba_administrator\",\n      \"name\": \"Administrator\",\n      \"documentation\": \"Internal user with elevated privileges for system management\",\n      \"source\": \"type_Admin\",\n      \"confidence\": 0.9\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.110968",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 20,
    "batch_size": 10
  },
  {
    "id": 220,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 3,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents an externally visible unit of functionality provided by technology infrastructure:\n- Database services (PostgreSQL, SQLite, Redis)\n- Web frameworks (Flask, Express, Django)\n- ORM layers (SQLAlchemy, Hibernate)\n- External APIs\n\nReview each candidate dependency and create TechnologyService elements.\n\nINCLUDE dependencies that:\n- Provide infrastructure functionality\n- Are key to the application architecture\n- Would appear in a technology stack diagram\n\nEXCLUDE dependencies that:\n- Are development tools only (pytest, black, mypy)\n- Are minor utilities\n- Are transitive dependencies\n\nSTRICT RULES:\n1. ONE TechnologyService per logical service, not per package\n2. Group related packages (e.g., SQLAlchemy + Flask-SQLAlchemy = ONE service)\n3. Max 3-4 TechnologyService elements per small application\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: techsvc_<service>\n2. Use Title Case for display name\n3. CANONICAL SERVICES (use these exact identifiers):\n   - techsvc_flask: Flask web framework\n   - techsvc_sqlalchemy: SQLAlchemy ORM/database access\n   - techsvc_jinja: Jinja templating\n   - techsvc_database: Database service (when separate from ORM)\n4. NEVER include both \"flask\" and \"sqlalchemy\" separately if Flask-SQLAlchemy is used\n5. NEVER use compound names like \"flask_sqlalchemy_integration\"\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-08T13:23:24.901913",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 206,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 2,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents an externally visible unit of functionality\nprovided by infrastructure or external systems, such as:\n- Databases (PostgreSQL, MongoDB, Redis, etc.)\n- Message queues (Kafka, RabbitMQ, etc.)\n- External APIs and HTTP clients\n- Cloud services (AWS S3, Azure Blob, etc.)\n- Authentication services\n\nReview each candidate dependency. Consider:\n- Does this provide infrastructure functionality?\n- Is it a service the application connects TO (not just a utility library)?\n- Would it appear in an architecture diagram?\n\nINCLUDE:\n- Database drivers and ORMs (sqlalchemy, psycopg2, pymongo)\n- HTTP clients for external APIs (requests, httpx, axios)\n- Message queue clients (kafka-python, pika)\n- Cloud SDK components (boto3, azure-storage)\n- Caching services (redis, memcached)\n\nEXCLUDE:\n- Standard library modules\n- Utility libraries (json parsing, date handling)\n- Testing frameworks\n- Development tools\n- Internal application modules\n\nNAMING RULES REMINDER:\n- Use lowercase snake_case for identifiers\n- Use consistent prefix for element type\n- Keep names generic and stable\n\nOutput stable, deterministic results.",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_postgresql\",\n      \"name\": \"PostgreSQL Database\",\n      \"documentation\": \"Relational database service for persistent data storage\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_redis_cache\",\n      \"name\": \"Redis Cache\",\n      \"documentation\": \"In-memory data store used for caching and session management\",\n      \"source\": \"dep_redis\",\n      \"confidence\": 0.9\n    }\n  ]\n}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-03T09:56:11.370273",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 221,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 4,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (n:`Graph:ExternalDependency`)\nWHERE n.active = true\nRETURN n.id as id,\n       COALESCE(n.dependencyName, n.name) as name,\n       labels(n) as labels,\n       properties(n) as properties",
    "input_model_query": null,
    "instruction": "You are identifying TechnologyService elements from external dependencies.\n\nA TechnologyService represents a PRIMARY technology service:\n- Web frameworks (Flask, Django, Express)\n- ORMs and database access (SQLAlchemy, TypeORM)\n- Template engines (Jinja2, Handlebars)\n\nONLY create TechnologyService for TOP-LEVEL dependencies.\n\nDO NOT create TechnologyService for:\n- Transitive dependencies\n- Development tools\n- Utility packages\n- Flask extensions (flask-sqlalchemy, flask-login) - use base package instead\n\nNAMING RULES (MANDATORY - FOLLOW EXACTLY):\n1. Use the BASE package name, not extensions:\n   - For flask-sqlalchemy: use techsvc_sqlalchemy\n   - For flask-login: use techsvc_flask (or skip if already have flask)\n2. CANONICAL NAMES (use these exact identifiers):\n   - Flask web framework: techsvc_flask\n   - SQLAlchemy ORM: techsvc_sqlalchemy\n   - Jinja2 templates: techsvc_jinja2\n3. Maximum 3 TechnologyService elements\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"techsvc_flask\",\n      \"name\": \"Flask Web Framework\",\n      \"documentation\": \"Python web framework providing HTTP handling and routing\",\n      \"source\": \"dep_flask\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"techsvc_sqlalchemy\",\n      \"name\": \"SQLAlchemy Database\",\n      \"documentation\": \"ORM and database access layer for Python applications\",\n      \"source\": \"dep_sqlalchemy\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:35:30.804180",
    "temperature": 0.0,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 110,
    "step_name": "TechnologyService",
    "phase": "generate",
    "version": 1,
    "sequence": 10,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (d:`Graph:ExternalDependency`) WHERE d.active = true RETURN d.id as id, d.name as name, d.package as package, d.version as version",
    "input_model_query": null,
    "instruction": "Analyze these external dependencies and derive ArchiMate TechnologyService elements.\nTechnologyService represents external services and libraries that the application depends on.\n\nGuidelines:\n- Group related dependencies into logical services\n- Flask/web frameworks -> \"Web Framework Service\"\n- Database libraries (SQLAlchemy, etc) -> \"Database Service\"\n- Authentication libraries -> \"Authentication Service\"\n- Use descriptive names reflecting the service purpose",
    "example": "{\"elements\": [\n  {\"identifier\": \"tech-svc:web-framework\", \"name\": \"Web Framework Service\", \"documentation\": \"Flask web framework\", \"source\": \"ExternalDependency:flask\", \"confidence\": 0.8}\n]}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.113411",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 111,
    "step_name": "Node",
    "phase": "generate",
    "version": 1,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Map infrastructure resources to Node elements. Include servers, containers, cloud resources that host or execute software.",
    "example": "{\"identifier\":\"node:app-server\",\"name\":\"Application Server\",\"type\":\"virtual\",\"platform\":\"AWS EC2\",\"confidence\":0.75}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.115645",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 212,
    "step_name": "Node",
    "phase": "generate",
    "version": 2,
    "sequence": 11,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \"docker\" OR f.fileName CONTAINS \"Dockerfile\" OR f.fileName CONTAINS \"compose\" OR f.fileName CONTAINS \"k8s\" OR f.fileName CONTAINS \"kubernetes\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Node elements from infrastructure files.\n\nA Node represents a computational or physical resource that hosts or executes artifacts:\n- Container definitions (Docker, Podman)\n- Orchestration configs (Kubernetes, Docker Compose)\n- Cloud resources (EC2, Azure VM, GCP Compute)\n- Server definitions\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become Node elements.\n\nINCLUDE files that:\n- Define container images (Dockerfile)\n- Define orchestration (docker-compose, k8s manifests)\n- Define cloud infrastructure\n- Specify runtime environments\n\nEXCLUDE files that:\n- Are just configuration (env files, settings)\n- Are test or development only\n- Don't represent deployable infrastructure\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: node_<name>\n2. Use Title Case for display name\n3. Keep names generic (e.g., \"Application Container\" not \"Flask App Docker v3\")\n4. Use standard infrastructure terminology\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"node_application_container\",\n      \"name\": \"Application Container\",\n      \"documentation\": \"Docker container running the main application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"node_database_container\",\n      \"name\": \"Database Container\",\n      \"documentation\": \"Container hosting the database service\",\n      \"source\": \"file_docker_compose\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:07:16.204294",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 112,
    "step_name": "Device",
    "phase": "generate",
    "version": 1,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "Identify physical devices from dependencies. Focus on hardware resources like servers, network equipment, or IoT devices.",
    "example": "{\"identifier\":\"dev:load-balancer\",\"name\":\"Load Balancer\",\"type\":\"network\",\"vendor\":\"F5\",\"confidence\":0.8}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.118135",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 213,
    "step_name": "Device",
    "phase": "generate",
    "version": 2,
    "sequence": 12,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (f:`Graph:File`) WHERE f.active = true AND (f.fileName CONTAINS \".tf\" OR f.fileName CONTAINS \"terraform\" OR f.fileName CONTAINS \"ansible\" OR f.fileName CONTAINS \"cloudformation\" OR f.fileType = \"infrastructure\") RETURN f.id as id, f.fileName as name, f.filePath as path, f.fileType as fileType",
    "input_model_query": null,
    "instruction": "You are identifying Device elements from infrastructure files.\n\nA Device represents physical hardware that hosts system software or artifacts:\n- Physical servers\n- Network equipment (load balancers, firewalls)\n- Storage devices\n- IoT devices\n\nEach candidate includes file information and graph metrics.\n\nReview each candidate and decide which should become Device elements.\n\nINCLUDE files that:\n- Define physical infrastructure (Terraform, Ansible)\n- Reference hardware resources\n- Configure network devices\n- Specify physical deployment targets\n\nEXCLUDE files that:\n- Define only virtual/cloud resources (those are Nodes)\n- Are application-level configs\n- Don't represent physical hardware\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: device_<name>\n2. Use Title Case for display name\n3. Use generic hardware terms\n4. Don't include vendor names unless essential\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"device_web_server\",\n      \"name\": \"Web Server\",\n      \"documentation\": \"Physical server hosting the web application tier\",\n      \"source\": \"file_terraform_servers\",\n      \"confidence\": 0.8\n    },\n    {\n      \"identifier\": \"device_load_balancer\",\n      \"name\": \"Load Balancer\",\n      \"documentation\": \"Network device distributing traffic across servers\",\n      \"source\": \"file_infra_network\",\n      \"confidence\": 0.85\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:07:18.501994",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 214,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 2,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "You are identifying SystemSoftware elements from external dependencies.\n\nSystemSoftware represents software that provides execution environments or platform services:\n- Runtime environments (Python, Node.js, JVM)\n- Operating systems\n- Database servers (when seen as platform, not service)\n- Middleware (web servers, app servers)\n\nEach candidate includes dependency information and graph metrics.\n\nReview each candidate and decide which should become SystemSoftware elements.\n\nINCLUDE dependencies that:\n- Provide runtime execution environments\n- Are platform-level software\n- Enable other software to run\n- Are infrastructure middleware\n\nEXCLUDE dependencies that:\n- Are application libraries (those inform other elements)\n- Are utilities or tools\n- Don't provide platform functionality\n\nNAMING RULES (CRITICAL FOR CONSISTENCY):\n1. Use lowercase snake_case for identifier: syssw_<name>\n2. Use Title Case for display name\n3. Use canonical software names (e.g., \"Python Runtime\" not \"python3.11\")\n4. Group by function, not version\n\nOutput stable, deterministic results.\n",
    "example": "{\n  \"elements\": [\n    {\n      \"identifier\": \"syssw_python_runtime\",\n      \"name\": \"Python Runtime\",\n      \"documentation\": \"Python interpreter providing the execution environment\",\n      \"source\": \"dep_python\",\n      \"confidence\": 0.95\n    },\n    {\n      \"identifier\": \"syssw_linux_os\",\n      \"name\": \"Linux Operating System\",\n      \"documentation\": \"Operating system hosting the application\",\n      \"source\": \"file_Dockerfile\",\n      \"confidence\": 0.9\n    }\n  ]\n}\n",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T13:07:20.757555",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 113,
    "step_name": "SystemSoftware",
    "phase": "generate",
    "version": 1,
    "sequence": 13,
    "enabled": true,
    "llm": true,
    "input_graph_query": "MATCH (e:`Graph:ExternalDependency`) WHERE e.active = true AND e.dependencyCategory IN [\"external_database\", \"external_service\"] RETURN e.id as id, e.dependencyName as name, e.description as description, e.ecosystem as ecosystem",
    "input_model_query": null,
    "instruction": "Map system software and platforms to SystemSoftware elements. Include runtimes, operating systems, middleware, and platform services.",
    "example": "{\"identifier\":\"sys:nodejs\",\"name\":\"Node.js Runtime\",\"version\":\"18.x\",\"category\":\"runtime\",\"confidence\":0.85}",
    "params": null,
    "is_active": false,
    "created_at": "2026-01-02T12:41:14.120450",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 224,
    "step_name": "degree_centrality",
    "phase": "enrich",
    "version": 1,
    "sequence": 0,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{}",
    "is_active": true,
    "created_at": "2026-01-08T14:35:52.905424",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 1,
    "step_name": "k_core_filter",
    "phase": "enrich",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph) OPTIONAL MATCH (n)-[r]-() WITH n, count(r) as degree RETURN n, degree",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"k\": 2, \"description\": \"Remove nodes with degree < k\"}",
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.069926",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 2,
    "step_name": "scc_detection",
    "phase": "enrich",
    "version": 1,
    "sequence": 2,
    "enabled": false,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"min_size\": 2, \"description\": \"Detect strongly connected components\"}",
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.076560",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 3,
    "step_name": "louvain_communities",
    "phase": "enrich",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"resolution\": 1.0, \"description\": \"Detect communities using Louvain algorithm\"}",
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.079345",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 4,
    "step_name": "articulation_points",
    "phase": "enrich",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]-(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"mark_critical\": true, \"description\": \"Identify articulation points (bridge nodes)\"}",
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.082007",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 5,
    "step_name": "pagerank",
    "phase": "enrich",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": false,
    "input_graph_query": "MATCH (n:Graph)-[r]->(m:Graph) RETURN n, r, m",
    "input_model_query": null,
    "instruction": null,
    "example": null,
    "params": "{\"damping\": 0.85, \"max_iter\": 100}",
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.084237",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 201,
    "step_name": "Completeness",
    "phase": "refine",
    "version": 1,
    "sequence": 1,
    "enabled": false,
    "llm": true,
    "is_active": false,
    "input_graph_query": "MATCH (n:Graph) WHERE n.significance > 0.5 AND n.active = true RETURN n",
    "input_model_query": "MATCH (e:Model) RETURN e",
    "instruction": "Compare graph nodes with ArchiMate elements. Identify graph nodes with high significance (>0.5) that don't have corresponding ArchiMate elements. For each missing element, suggest creating an appropriate ArchiMate element with proper type, name, and relationships. Return an array of new elements to add with their confidence scores.",
    "example": "{\"new_elements\":[{\"identifier\":\"ac:payment-processor\",\"type\":\"ApplicationComponent\",\"name\":\"Payment Processor\",\"source_node\":\"Graph:PaymentService\",\"reason\":\"High-significance service node without ArchiMate representation\",\"confidence\":0.85}],\"new_relationships\":[]}",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.123083",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 202,
    "step_name": "RelationshipConsistency",
    "phase": "refine",
    "version": 1,
    "sequence": 2,
    "enabled": false,
    "llm": true,
    "input_graph_query": "MATCH (source:Graph)-[r]->(target:Graph) WHERE source.significance > 0.3 AND target.significance > 0.3 AND source.active = true AND target.active = true RETURN source, type(r) as rel_type, target",
    "input_model_query": "MATCH (source:Model)-[r]->(target:Model) RETURN source, type(r) as rel_type, target",
    "instruction": "Compare relationships between graph nodes and ArchiMate elements. Identify missing or incorrect relationships in the ArchiMate model. For each discrepancy, suggest adding or updating relationships using appropriate ArchiMate relationship types (Composition, Aggregation, Serving, Realization, Access, Flow). Ensure relationship types follow ArchiMate metamodel rules. Return arrays of new and updated relationships.",
    "example": "{\"new_elements\":[],\"new_relationships\":[{\"source\":\"ac:api-gateway\",\"target\":\"as:user-service\",\"type\":\"Serving\",\"reason\":\"Graph shows API Gateway calls User Service, missing in ArchiMate\",\"confidence\":0.9}],\"updated_relationships\":[{\"source\":\"ac:database\",\"target\":\"do:user-data\",\"old_type\":\"Composition\",\"new_type\":\"Access\",\"reason\":\"Database accesses data, not composes it\",\"confidence\":0.85}]}",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.125716",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 203,
    "step_name": "LayeringAbstraction",
    "phase": "refine",
    "version": 1,
    "sequence": 3,
    "enabled": false,
    "llm": true,
    "input_graph_query": "MATCH (n:Graph) WHERE n.active = true RETURN n, labels(n) as node_labels, n.category as category",
    "input_model_query": "MATCH (e:Model) RETURN e, e.type as element_type, e.layer as layer",
    "instruction": "Analyze the ArchiMate model for proper layering and abstraction. Check: 1) Elements are in correct layers (Business/Application/Technology), 2) Abstraction levels are appropriate (not too technical in business layer, not too abstract in technology layer), 3) Cross-layer relationships follow ArchiMate patterns. Suggest reclassifying elements or splitting/merging elements to improve architectural clarity. Return arrays of reclassified elements, split suggestions, and new relationships.",
    "example": "{\"reclassified_elements\":[{\"identifier\":\"ac:user-authentication\",\"current_type\":\"ApplicationComponent\",\"suggested_type\":\"ApplicationService\",\"reason\":\"Represents behavior/capability, not a structural component\",\"confidence\":0.8}],\"split_suggestions\":[{\"identifier\":\"ac:monolith-app\",\"suggested_elements\":[{\"type\":\"ApplicationComponent\",\"name\":\"User Management Module\"},{\"type\":\"ApplicationComponent\",\"name\":\"Order Processing Module\"},{\"type\":\"ApplicationComponent\",\"name\":\"Inventory Module\"}],\"reason\":\"Large monolithic component should be decomposed for clarity\",\"confidence\":0.7}],\"new_relationships\":[]}",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-02T12:41:14.128141",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 30,
    "batch_size": 10
  },
  {
    "id": 225,
    "step_name": "GlobalRelationships",
    "phase": "relationship",
    "version": 1,
    "sequence": 100,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "You are deriving ArchiMate relationships between elements.\n\nDETERMINISM REQUIREMENTS (CRITICAL):\n- Output the SAME relationships every time for the same input\n- Use ONLY the canonical relationship patterns below\n- Do NOT add speculative or uncertain relationships\n- Limit to MAX 15 relationships total\n\nCANONICAL RELATIONSHIP PATTERNS (use ONLY these patterns):\n\n1. TechnologyService → DataObject: Access\n   techsvc_* → do_* = Access (technology reads/writes data)\n\n2. ApplicationService → BusinessObject: Flow\n   as_* → bo_* = Flow (service processes business data)\n\n3. BusinessProcess → BusinessObject: Access\n   bp_* → bo_* = Access (process creates/modifies data)\n\n4. BusinessObject → BusinessObject: Composition\n   bo_invoice → bo_position = Composition (parent contains child)\n\n5. TechnologyService → ApplicationService: Serving\n   techsvc_flask → as_* = Serving (framework enables service)\n\n6. DataObject → TechnologyService: Realization\n   do_requirements → techsvc_* = Realization (config enables tech)\n\nRELATIONSHIP TYPE RULES:\n- Composition: ONLY for parent-child (Invoice contains Position)\n- Access: ONLY for read/write to DataObject targets\n- Serving: ONLY for service provision between layers\n- Flow: ONLY for data transfer\n- Realization: ONLY for implementation\n\nINVALID TYPES (NEVER use):\n- Association, Dependency, Uses, Triggers\n\nPRIORITY ORDER (stop at limit):\n1. TechnologyService → DataObject (Access)\n2. BusinessProcess → BusinessObject (Access)\n3. BusinessObject → BusinessObject (Composition)\n4. TechnologyService → ApplicationService (Serving)\n\nOutput stable, deterministic relationships only.",
    "example": "{\n  \"relationships\": [\n    {\"source\": \"techsvc_sqlalchemy\", \"target\": \"do_application_database\", \"relationship_type\": \"Access\", \"confidence\": 0.95},\n    {\"source\": \"bp_create_invoice\", \"target\": \"bo_invoice\", \"relationship_type\": \"Access\", \"confidence\": 0.9},\n    {\"source\": \"bo_invoice\", \"target\": \"bo_position\", \"relationship_type\": \"Composition\", \"confidence\": 0.9},\n    {\"source\": \"techsvc_flask\", \"target\": \"as_invoice_form\", \"relationship_type\": \"Serving\", \"confidence\": 0.85}\n  ]\n}",
    "params": null,
    "is_active": true,
    "created_at": "2026-01-08T16:07:16.061820",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": 50,
    "batch_size": 20
  },
  {
    "id": 301,
    "step_name": "duplicate_elements",
    "phase": "refine",
    "version": 1,
    "sequence": 1,
    "enabled": true,
    "llm": true,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find and handle duplicate ArchiMate elements: Tier 1 (exact name+type) auto-merge, Tier 2 (fuzzy match) flag, Tier 3 (semantic via LLM) merge only with >0.95 confidence.",
    "example": null,
    "params": "{\"fuzzy_threshold\": 0.85, \"semantic_threshold\": 0.95, \"auto_merge_tier2\": false}",
    "is_active": true,
    "created_at": "2026-01-09T00:00:00.000000",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": null,
    "batch_size": null
  },
  {
    "id": 302,
    "step_name": "orphan_elements",
    "phase": "refine",
    "version": 1,
    "sequence": 2,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find ArchiMate elements with no relationships. Flag them for review or propose relationships based on source graph patterns.",
    "example": null,
    "params": "{\"disable_orphans\": false, \"min_importance\": 0}",
    "is_active": true,
    "created_at": "2026-01-09T00:00:00.000000",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": null,
    "batch_size": null
  },
  {
    "id": 303,
    "step_name": "duplicate_relationships",
    "phase": "refine",
    "version": 1,
    "sequence": 3,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Find and remove duplicate relationships (same source, target, type). Also check for redundant relationship pairs.",
    "example": null,
    "params": "{\"check_redundant\": true}",
    "is_active": true,
    "created_at": "2026-01-09T00:00:00.000000",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": null,
    "batch_size": null
  },
  {
    "id": 304,
    "step_name": "cross_layer_coherence",
    "phase": "refine",
    "version": 1,
    "sequence": 4,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Validate ArchiMate cross-layer relationships: Business->Application->Technology. Flag elements without cross-layer connections.",
    "example": null,
    "params": "{\"check_business_to_app\": true, \"check_app_to_tech\": true}",
    "is_active": true,
    "created_at": "2026-01-09T00:00:00.000000",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": null,
    "batch_size": null
  },
  {
    "id": 305,
    "step_name": "structural_consistency",
    "phase": "refine",
    "version": 1,
    "sequence": 5,
    "enabled": true,
    "llm": false,
    "input_graph_query": null,
    "input_model_query": null,
    "instruction": "Validate that source graph structural patterns (containment, calls) are preserved in the ArchiMate model.",
    "example": null,
    "params": "{\"check_containment\": true, \"check_calls\": true}",
    "is_active": true,
    "created_at": "2026-01-09T00:00:00.000000",
    "temperature": null,
    "max_tokens": null,
    "max_candidates": null,
    "batch_size": null
  }
]